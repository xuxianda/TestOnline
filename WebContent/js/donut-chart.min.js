!function(t,i){"object"==typeof exports&&"object"==typeof module?module.exports=i():"function"==typeof define&&define.amd?define([],i):"object"==typeof exports?exports.DonutChart=i():t.DonutChart=i()}("undefined"!=typeof self?self:this,function(){return function(t){function i(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}var o={};return i.m=t,i.c=o,i.d=function(t,o,e){i.o(t,o)||Object.defineProperty(t,o,{configurable:!1,enumerable:!0,get:e})},i.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(o,"a",o),o},i.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},i.p="",i(i.s=0)}([function(t,i,o){"use strict";t.exports=o(1)},function(module,exports,__webpack_require__){"use strict";function DonutChart(t,i){if(this.option={x:"50%",y:"50%",radius:"30%",lineWidth:"5%",startAngle:0,title:{show:!0,text:void 0,textStyle:{fontStyle:"normal",fontVariant:"normal",fontWeight:"bold",fontSize:"24px",lineHeight:"30px",fontFamily:"Arial",color:"#9f9f9f"},subtext:void 0,subtextStyle:{fontStyle:"normal",fontVariant:"normal",fontWeight:"bold",fontSize:"24px",lineHeight:"30px",fontFamily:"Arial",color:"#e53344"},x:"50%",y:"50%"},tooltip:{show:!0,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",fontSize:"24px",lineHeight:"30px",fontFamily:"Arial",color:"white",backgroundColor:"#00000099"},max:100,data:[],label:{show:!0,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",fontSize:"24px",lineHeight:"30px",fontFamily:"Arial",color:"#999"},capType:"round",selectedStyle:{color:"white",borderWidth:10},color:["#FF7F00","#FFFF00 ","#00FF00 ","#00FFFF ","#0000FF","#8B00FF","#FF0000 "],labelCoverTitle:!0,backgroundArc:"#999"},this.option=utils.extend(!0,this.option,i),this.option.color.length<this.option.data.length)throw"option.color 颜色少于 option.data";this.canvas=document.getElementById(t),this.width=this.canvas.width,this.height=this.canvas.height,this.ctx=this.canvas.getContext("2d"),this.circleX=utils.formatPercent(i.x,"option.x")*this.width,this.circleY=utils.formatPercent(i.y,"option.x")*this.height,this.lineWidth=utils.formatPercent(i.lineWidth,"option.lineWidth")*(this.width>this.height?this.height:this.width),this.label=i.label,this.radius=utils.formatPercent(i.radius,"option.radius")*(this.width>this.height?this.height:this.width),this.data=i.data,this.color=i.color,this.rate=this.canvas[this.width>this.height?"offsetHeight":"offsetWidth"]/this[this.width>this.height?"height":"width"]}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},utils=__webpack_require__(2);module.exports=DonutChart,DonutChart.prototype.drawArc=function(t,i,o,e){this.ctx.beginPath(),this.ctx.arc(0,0,this.radius,utils.angelToRadian(t),utils.angelToRadian(i),!1),e&&(this.ctx.lineWidth=e),this.ctx.strokeStyle=o,this.ctx.stroke(),this.ctx.closePath()},DonutChart.prototype.drawTitle=function(t){if(!this.option.title.show)return!1;if(this.option.title&&!t){this.ctx.save(),this.ctx.beginPath(),this.ctx.textAlign="start",this.ctx.textBaseline="bottom";var i=0;i=utils.formatPx(this.option.title.textStyle.lineHeight,"option.title.textStyle.lineHeight")+utils.formatPx(this.option.title.subtextStyle.lineHeight,"option.title.subtextStyle.lineHeight"),this.ctx.translate(utils.formatPercent(this.option.title.x,"option.title.x")*this.width,utils.formatPercent(this.option.title.y,"option.title.y")*this.height-i/2),void 0!==this.option.title.text&&(this.ctx.font=this.option.title.textStyle.fontStyle+" "+this.option.title.textStyle.fontVariant+" "+this.option.title.textStyle.fontWeight+" "+this.option.title.textStyle.fontSize+(this.option.title.textStyle.lineHeight?"/"+this.option.title.textStyle.lineHeight:"")+" "+this.option.title.textStyle.fontFamily,this.ctx.fillStyle=this.option.title.textStyle.color,this.ctx.fillText(this.option.title.text,-this.ctx.measureText(this.option.title.text).width/2,utils.formatPx(this.option.title.textStyle.lineHeight,"option.title.textStyle.lineHeight"))),void 0!==this.option.title.subtext&&(this.ctx.font=this.option.title.subtextStyle.fontStyle+" "+this.option.title.subtextStyle.fontVariant+" "+this.option.title.subtextStyle.fontWeight+" "+this.option.title.subtextStyle.fontSize+(this.option.title.subtextStyle.lineHeight?"/"+this.option.title.subtextStyle.lineHeight:"")+" "+this.option.title.subtextStyle.fontFamily,this.ctx.fillStyle=this.option.title.subtextStyle.color,this.ctx.fillText(this.option.title.subtext,-this.ctx.measureText(this.option.title.subtext).width/2,utils.formatPx(this.option.title.textStyle.lineHeight,"option.title.textStyle.lineHeight")+utils.formatPx(this.option.title.subtextStyle.lineHeight,"option.title.subtextStyle.lineHeight"))),this.ctx.restore()}},DonutChart.prototype.drawTip=function(t){var i=this;if(!this.option.tooltip.show)return!1;this.ctx.save(),this.ctx.rotate(utils.angelToRadian(90+this.option.startAngle)),this.ctx.beginPath();var o=this.option.tooltip.fontStyle+" "+this.option.tooltip.fontVariant+" "+this.option.tooltip.fontWeight+" "+this.option.tooltip.fontSize+(this.option.tooltip.lineHeight?"/"+this.option.tooltip.lineHeight:"")+" "+this.option.tooltip.fontFamily;this.ctx.font=o,this.ctx.fillStyle=this.option.tooltip.color,this.ctx.textAlign="start",this.ctx.textBaseline="bottom";var e=0,n=0,l=0,h=0,r=[];if("object"==_typeof(t.content[0]))t.content.forEach(function(t,o){l=0;for(var a in t){var s=t[a];i.option.tooltip.rich[a]||(i.option.tooltip.rich[a]={});var c=i.option.tooltip.rich[a].fontStyle?i.option.tooltip.rich[a].fontStyle:i.option.tooltip.fontStyle,p=i.option.tooltip.rich[a].fontVariant?i.option.tooltip.rich[a].fontVariant:i.option.tooltip.fontVariant,f=i.option.tooltip.rich[a].fontWeight?i.option.tooltip.rich[a].fontWeight:i.option.tooltip.fontWeight,u=i.option.tooltip.rich[a].fontSize?i.option.tooltip.rich[a].fontSize:i.option.tooltip.fontSize,x=i.option.tooltip.rich[a].lineHeight?i.option.tooltip.rich[a].lineHeight:i.option.tooltip.lineHeight,d=i.option.tooltip.rich[a].fontFamily?i.option.tooltip.rich[a].fontFamily:i.option.tooltip.fontFamily;i.ctx.font=c+" "+p+" "+f+" "+u+(x?"/"+x:"")+" "+d,i.ctx.fillStyle=i.option.tooltip.rich[a].color?i.option.tooltip.rich[a].color:i.option.tooltip.color,l+=i.ctx.measureText(s).width,utils.formatPx(x,"option.tooltip.lineHeight")>h&&(h=utils.formatPx(x,"option.tooltip.lineHeight"))}r[o]=h,e+=h,l>n&&(n=l)}),this.ctx.rect(t.x+15,t.y+10,n+10,e),this.ctx.fillStyle=this.option.tooltip.backgroundColor,this.ctx.fill(),e=0,t.content.forEach(function(o,n){l=0,h=r[n],e+=h;for(var a in o){var s=o[a];i.option.tooltip.rich[a]||(i.option.tooltip.rich[a]={});var c=i.option.tooltip.rich[a].fontStyle?i.option.tooltip.rich[a].fontStyle:i.option.tooltip.fontStyle,p=i.option.tooltip.rich[a].fontVariant?i.option.tooltip.rich[a].fontVariant:i.option.tooltip.fontVariant,f=i.option.tooltip.rich[a].fontWeight?i.option.tooltip.rich[a].fontWeight:i.option.tooltip.fontWeight,u=i.option.tooltip.rich[a].fontSize?i.option.tooltip.rich[a].fontSize:i.option.tooltip.fontSize,x=i.option.tooltip.rich[a].lineHeight?i.option.tooltip.rich[a].lineHeight:i.option.tooltip.lineHeight,d=i.option.tooltip.rich[a].fontFamily?i.option.tooltip.rich[a].fontFamily:i.option.tooltip.fontFamily;i.ctx.font=c+" "+p+" "+f+" "+u+(x?"/"+x:"")+" "+d,i.ctx.fillStyle=i.option.tooltip.rich[a].color?i.option.tooltip.rich[a].color:i.option.tooltip.color,i.ctx.fillText(s,t.x+20+l,t.y+10+e),l+=i.ctx.measureText(s).width}});else{var a=this.option.tooltip.lineHeight;t.content.forEach(function(t,o){e+=utils.formatPx(a,"option.tooltip.lineHeight or option.tooltip.rich[].lineHeight"),(l=i.ctx.measureText(t).width)>n&&(n=l)}),this.ctx.rect(t.x-5,t.y,n+10,e),this.ctx.fillStyle="#00000088",this.ctx.fill(),this.ctx.fillStyle=this.option.tooltip.color,e=0,t.content.forEach(function(o,n){e+=utils.formatPx(a,"option.tooltip.lineHeight  or option.tooltip.rich[].lineHeight"),i.ctx.fillText(o,t.x,t.y+e)})}this.ctx.restore()},DonutChart.prototype.drawLabel=function(content){var _this3=this;if(!this.option.label.show)return!1;this.ctx.save(),this.ctx.rotate(utils.angelToRadian(90+this.option.startAngle)),this.ctx.beginPath();var default_font=this.option.label.fontStyle+" "+this.option.label.fontVariant+" "+this.option.label.fontWeight+" "+this.option.label.fontSize+(this.option.label.lineHeight?"/"+this.option.label.lineHeight:"")+" "+this.option.label.fontFamily;this.ctx.font=default_font,this.ctx.fillStyle=this.option.label.color,this.ctx.textAlign="center",this.ctx.textBaseline="bottom";var totalHeigth=0,rowWidth=0,maxWidth=0,maxLineHeight=0,rowLineHeight=[],rowWidths=[];if("object"==_typeof(content[0]))content.forEach(function(t,i){rowWidth=0;for(var o in t){var e=t[o];_this3.option.label.rich[o]||(_this3.option.label.rich[o]={});var n=_this3.option.label.rich[o].fontStyle?_this3.option.label.rich[o].fontStyle:_this3.option.label.fontStyle,l=_this3.option.label.rich[o].fontVariant?_this3.option.label.rich[o].fontVariant:_this3.option.label.fontVariant,h=_this3.option.label.rich[o].fontWeight?_this3.option.label.rich[o].fontWeight:_this3.option.label.fontWeight,r=_this3.option.label.rich[o].fontSize?_this3.option.label.rich[o].fontSize:_this3.option.label.fontSize,a=_this3.option.label.rich[o].lineHeight?_this3.option.label.rich[o].lineHeight:_this3.option.label.lineHeight,s=_this3.option.label.rich[o].fontFamily?_this3.option.label.rich[o].fontFamily:_this3.option.label.fontFamily;_this3.ctx.font=n+" "+l+" "+h+" "+r+(a?"/"+a:"")+" "+s,_this3.ctx.fillStyle=_this3.option.label.rich[o].color?_this3.option.label.rich[o].color:_this3.option.label.color,rowWidth+=_this3.ctx.measureText(e).width,utils.formatPx(a,"option.label.lineHeight or option.label.rich[].lineHeight")>maxLineHeight&&(maxLineHeight=utils.formatPx(a,"option.label.lineHeight or option.label.rich[].lineHeight"))}rowLineHeight[i]=maxLineHeight,rowWidths[i]=rowWidth,rowWidth>maxWidth&&(maxWidth=rowWidth)}),this.ctx.translate(0,-eval(rowLineHeight.join("+"))/2),totalHeigth=0,content.forEach(function(t,i){_this3.ctx.save(),_this3.ctx.translate(-rowWidths[i]/2,0),_this3.ctx.textAlign="start",rowWidth=0,maxLineHeight=rowLineHeight[i],totalHeigth+=maxLineHeight;for(var o in t){var e=t[o];_this3.option.label.rich[o]||(_this3.option.label.rich[o]={});var n=_this3.option.label.rich[o].fontStyle?_this3.option.label.rich[o].fontStyle:_this3.option.label.fontStyle,l=_this3.option.label.rich[o].fontVariant?_this3.option.label.rich[o].fontVariant:_this3.option.label.fontVariant,h=_this3.option.label.rich[o].fontWeight?_this3.option.label.rich[o].fontWeight:_this3.option.label.fontWeight,r=_this3.option.label.rich[o].fontSize?_this3.option.label.rich[o].fontSize:_this3.option.label.fontSize,a=_this3.option.label.rich[o].lineHeight?_this3.option.label.rich[o].lineHeight:_this3.option.label.lineHeight,s=_this3.option.label.rich[o].fontFamily?_this3.option.label.rich[o].fontFamily:_this3.option.label.fontFamily;_this3.ctx.font=n+" "+l+" "+h+" "+r+(a?"/"+a:"")+" "+s,_this3.ctx.fillStyle=_this3.option.label.rich[o].color?_this3.option.label.rich[o].color:_this3.option.label.color,_this3.ctx.fillText(e,rowWidth,totalHeigth),rowWidth+=_this3.ctx.measureText(e).width}_this3.ctx.restore()});else{var default_lineHeight=this.option.label.lineHeight;content.forEach(function(t,i){totalHeigth+=utils.formatPx(default_lineHeight,"option.label.lineHeight"),(rowWidth=_this3.ctx.measureText(t).width)>maxWidth&&(maxWidth=rowWidth)});var halfHeight=totalHeigth/2,startY=halfHeight-utils.formatPx(default_lineHeight,"option.label.lineHeight");this.ctx.fillStyle=this.option.label.color,totalHeigth=0,content.forEach(function(t,i){_this3.ctx.fillText(t,0,-startY+totalHeigth),totalHeigth+=utils.formatPx(default_lineHeight,"option.label.lineHeight")})}this.ctx.restore()},DonutChart.prototype.init=function(t,i){var o=this;if(t&&"function"!=typeof t)throw"init() 第一个参数必须是函数";if(i&&"boolean"!=typeof i)throw"labelCoverTitle 必须是boolean";this.canvas.width=this.canvas.width,this.drawTitle(i),this.ctx.translate(this.circleX,this.circleY),this.ctx.rotate(utils.angelToRadian(-90+this.option.startAngle)),this.ctx.lineWidth=this.lineWidth,this.ctx.lineCap=this.option.capType;var e=this,n=[],l=0,h=0;if(this.data.forEach(function(t,i){l+=t.value,t.color=t.color||o.color[i]}),0==l)return this.drawArc(0,360,this.option.backgroundArc),!1;if("gauge"==this.option.type){if(this.option.data[0].value>100)throw"this.option.data 里的 value 值不能大于100";l=this.option.max,this.drawArc(0,360,this.option.backgroundArc)}this.data.sort(function(t,i){var o=t.value,e=i.value;return o>e?1:o<e?-1:0}),this.data.forEach(function(t,i){var o,e;t.value/l==1?e="100":(o=(t.value/l).toFixed(4).toString().slice(2).split(""),o.splice(2,0,"."),e=o.join("")),n[i]={index:i,name:t.name,value:t.value,startAngle:h,endAngle:t.value/l*360+h,percent:e+"%",color:t.color},h=n[i].endAngle}),n.forEach(function(t,i){o.drawArc(t.startAngle,t.endAngle,t.color)});for(var r=0,a=n.length;r<a;r++)0!=n[r].value&&this.drawArc(n[r].startAngle,n[r].startAngle+.1,n[r].color);this.canvas.onmousemove=function(i){var o=i.offsetX-this.offsetWidth/2,l=i.offsetY-this.offsetHeight/2,h=o*o,r=l*l;if(Math.sqrt(h+r)>(e.radius-e.lineWidth)*e.rate&&Math.sqrt(h+r)<(e.radius+e.lineWidth)*e.rate)for(var a=Math.atan2(o,-l)/(Math.PI/180)>0?Math.atan2(o,-l)/(Math.PI/180):360+Math.atan2(o,-l)/(Math.PI/180),s=0,c=n.length;s<c;s++){if(a<n[s].endAngle){e.init(t,e.option.labelCoverTitle),e.drawArc(n[s].startAngle,n[s].endAngle,e.option.selectedStyle.color,e.option.selectedStyle.borderWidth+e.lineWidth),e.drawArc(n[s].startAngle,n[s].endAngle,n[s].color,e.lineWidth);var p=[];p="function"==typeof e.option.label.formatter?utils.formatterToObject(e.option.label.formatter(n[s])):[n[s].name,n[s].value],e.drawLabel(p),p=[],p="function"==typeof e.option.tooltip.formatter?utils.formatterToObject(e.option.tooltip.formatter(n[s])):[n[s].name,n[s].value],e.drawTip({x:o/e.rate,y:l/e.rate,content:p}),t(n[s]);break}e.init(t)}else e.init(t)}}},function(t,i,o){"use strict";var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n={},l=n.toString,h=n.hasOwnProperty,r={};t.exports={formatPercent:function(t,i){if("string"==typeof t&&t.indexOf("%")==t.length-1)return t.slice(0,-1)/100;throw i+" 参数格式错误"},formatPx:function(t,i){if("string"==typeof t&&t.indexOf("px")==t.length-2)return+t.slice(0,-2);throw i+" 参数格式错误"},formatterToObject:function(t){if(void 0===t)return!1;if("string"!=typeof t)throw"formatter 必须返回一个字符串";try{var i=t.split("\n"),o=[];return/\{(\w+)\|([\s\S]*?)\}/g.test(t)?i.forEach(function(t,i){var e="";t.replace(/\{(\w+)\|([\s\S]*?)\}/g,',"$1":"$2",').split(",").forEach(function(t,i){t.indexOf(":")>-1?e+=t+",":e+='"default_'+i+'":"'+t+'",'}),o.push(JSON.parse("{"+e.slice(0,-1)+"}"))}):i.forEach(function(t){o.push(t)}),o}catch(t){throw"formatter 的格式不正确"}},angelToRadian:function(t,i){if(isNaN(t))throw i+"不是一个有效数字";return t*Math.PI/180},extend:function(){var t,i,o,n,l,h,r=arguments[0]||{},a=1,s=arguments.length,c=!1;for("boolean"==typeof r&&(c=r,r=arguments[a]||{},a++),"object"===(void 0===r?"undefined":e(r))||this.isFunction(r)||(r={}),a===s&&(r=this,a--);a<s;a++)if(null!=(l=arguments[a]))for(n in l)t=r[n],o=l[n],r!==o&&(c&&o&&(this.isPlainObject(o)||(i=this.isArray(o)))?(i?(i=!1,h=t&&this.isArray(t)?t:[]):h=t&&this.isPlainObject(t)?t:{},r[n]=this.extend(c,h,o)):void 0!==o&&(r[n]=o));return r},isFunction:function(t){return"function"==typeof t},isPlainObject:function(t){var i;if(!t||"object"!==this.type(t)||t.nodeType||this.isWindow(t))return!1;try{if(t.constructor&&!h.call(t,"constructor")&&!h.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}if(!r.ownFirst)for(i in t)return h.call(t,i);for(i in t);return void 0===i||h.call(t,i)},type:function(t){return null==t?t+"":"object"===(void 0===t?"undefined":e(t))||"function"==typeof t?n[l.call(t)]||"object":void 0===t?"undefined":e(t)},isWindow:function(t){return null!=t&&t==t.window},isArray:function(t){return"array"===this.type(t)}}}])});
//# sourceMappingURL=donut-chart.min.js.map